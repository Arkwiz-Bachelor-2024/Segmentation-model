We are running from this directory: /cluster/work/petteed/seg_model/Segmentation-model
---------------------------------------------------------
The name of the job is: Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO
The job ID is 19081794
---------------------------------------------------------
Number of GPUs : 2,8,9
---------------------------------------------------------
Assert Enviroment modules are loaded...
---------------------------------------------------------
Assert python modules are loaded....
Requirement already satisfied: scikit-learn in /cluster/home/petteed/.local/lib/python3.10/site-packages (1.4.1.post1)
Requirement already satisfied: joblib>=1.2.0 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from scikit-learn) (1.3.2)
Requirement already satisfied: scipy>=1.6.0 in /cluster/apps/eb/software/SciPy-bundle/2022.05-foss-2022a/lib/python3.10/site-packages (from scikit-learn) (1.8.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: numpy<2.0,>=1.19.5 in /cluster/apps/eb/software/SciPy-bundle/2022.05-foss-2022a/lib/python3.10/site-packages (from scikit-learn) (1.22.3)
Requirement already satisfied: matplotlib in /cluster/home/petteed/.local/lib/python3.10/site-packages (3.8.3)
Requirement already satisfied: packaging>=20.0 in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (from matplotlib) (20.9)
Requirement already satisfied: pyparsing>=2.3.1 in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (from matplotlib) (3.0.8)
Requirement already satisfied: kiwisolver>=1.3.1 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from matplotlib) (1.4.5)
Requirement already satisfied: numpy<2,>=1.21 in /cluster/apps/eb/software/SciPy-bundle/2022.05-foss-2022a/lib/python3.10/site-packages (from matplotlib) (1.22.3)
Requirement already satisfied: python-dateutil>=2.7 in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (from matplotlib) (2.8.2)
Requirement already satisfied: cycler>=0.10 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: contourpy>=1.0.1 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from matplotlib) (1.2.0)
Requirement already satisfied: fonttools>=4.22.0 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from matplotlib) (4.50.0)
Requirement already satisfied: pillow>=8 in /cluster/home/petteed/.local/lib/python3.10/site-packages (from matplotlib) (10.2.0)
Requirement already satisfied: six>=1.5 in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib) (1.16.0)
Requirement already satisfied: cython in /cluster/apps/eb/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages (0.29.28)
Collecting git+https://github.com/lucasb-eyer/pydensecrf.git
  Cloning https://github.com/lucasb-eyer/pydensecrf.git to /tmp/pip-req-build-3yxe5jro
  Resolved https://github.com/lucasb-eyer/pydensecrf.git to commit 2723c7fa4f2ead16ae1ce3d8afe977724bb8f87f
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
---------------------------------------------------------
GPU specifications:
Fri Apr 12 19:59:29 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:14:00.0 Off |                    0 |
| N/A   27C    P0              32W / 250W |      4MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-PCIE-40GB          On  | 00000000:C1:00.0 Off |                    0 |
| N/A   28C    P0              34W / 250W |      4MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-PCIE-40GB          On  | 00000000:C2:00.0 Off |                    0 |
| N/A   26C    P0              34W / 250W |      4MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
---------------------------------------------------------
Training model:
---------------------------------------------------------
---------------------------------------------------------------------------------------------------
Enviroment:
TensorFlow version: 2.11.0
GPUs Available:  [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')]
---------------------------------------------------------------------------------------------------
Details:
---------------------------------------------------------------------------------------------------
Classes:  5
Total batch size: 12
Epochs 100
---------------------------------------------------------------------------------------------------
Data shape
Image shape: (12, 512, 512, 3)
Mask shape: (12, 512, 512, 1)
Training dataset:  <BatchDataset element_spec=(TensorSpec(shape=(None, 512, 512, 3), dtype=tf.float32, name=None), TensorSpec(shape=(None, 512, 512, 1), dtype=tf.uint8, name=None))>
Validation dataset: <BatchDataset element_spec=(TensorSpec(shape=(None, 512, 512, 3), dtype=tf.float32, name=None), TensorSpec(shape=(None, 512, 512, 1), dtype=tf.uint8, name=None))>
---------------------------------------------------------------------------------------------------
Epoch 1/100

Epoch 1: val_loss improved from inf to 1.03809, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO
623/623 - 1439s - loss: 1.0958 - accuracy: 0.5867 - mean_io_u: 0.1688 - val_loss: 1.0381 - val_accuracy: 0.6002 - val_mean_io_u: 0.1200 - 1439s/epoch - 2s/step
Epoch 2/100

Epoch 2: val_loss did not improve from 1.03809

Epoch 1: Learning rate is 0.002.
623/623 - 366s - loss: 1.4846 - accuracy: 0.5793 - mean_io_u: 0.1159 - val_loss: 1.3937 - val_accuracy: 0.6002 - val_mean_io_u: 0.1200 - 366s/epoch - 587ms/step
Epoch 3/100

Epoch 3: val_loss improved from 1.03809 to 0.95533, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 2: Learning rate is 0.004.
623/623 - 398s - loss: 1.0805 - accuracy: 0.5619 - mean_io_u: 0.1193 - val_loss: 0.9553 - val_accuracy: 0.6002 - val_mean_io_u: 0.1200 - 398s/epoch - 639ms/step
Epoch 4/100

Epoch 4: val_loss improved from 0.95533 to 0.95162, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 3: Learning rate is 0.006.
623/623 - 401s - loss: 1.0177 - accuracy: 0.5523 - mean_io_u: 0.1409 - val_loss: 0.9516 - val_accuracy: 0.6002 - val_mean_io_u: 0.1200 - 401s/epoch - 643ms/step
Epoch 5/100

Epoch 5: val_loss improved from 0.95162 to 0.94105, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 4: Learning rate is 0.008.
623/623 - 398s - loss: 1.0232 - accuracy: 0.5579 - mean_io_u: 0.1472 - val_loss: 0.9411 - val_accuracy: 0.6002 - val_mean_io_u: 0.1202 - 398s/epoch - 639ms/step
Epoch 6/100

Epoch 6: val_loss improved from 0.94105 to 0.91462, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 5: Learning rate is 0.01.
623/623 - 398s - loss: 1.0210 - accuracy: 0.5651 - mean_io_u: 0.1509 - val_loss: 0.9146 - val_accuracy: 0.6014 - val_mean_io_u: 0.1242 - 398s/epoch - 640ms/step
Epoch 7/100

Epoch 7: val_loss did not improve from 0.91462

Epoch 6: Learning rate is 0.01.
623/623 - 361s - loss: 1.0102 - accuracy: 0.5683 - mean_io_u: 0.1518 - val_loss: 0.9766 - val_accuracy: 0.6403 - val_mean_io_u: 0.1769 - 361s/epoch - 579ms/step
Epoch 8/100

Epoch 8: val_loss did not improve from 0.91462

Epoch 7: Learning rate is 0.01.
623/623 - 367s - loss: 0.9920 - accuracy: 0.5684 - mean_io_u: 0.1500 - val_loss: 0.9688 - val_accuracy: 0.6542 - val_mean_io_u: 0.1889 - 367s/epoch - 589ms/step
Epoch 9/100

Epoch 9: val_loss did not improve from 0.91462

Epoch 8: Learning rate is 0.01.
623/623 - 366s - loss: 0.9800 - accuracy: 0.5708 - mean_io_u: 0.1503 - val_loss: 0.9937 - val_accuracy: 0.6626 - val_mean_io_u: 0.1925 - 366s/epoch - 588ms/step
Epoch 10/100

Epoch 10: val_loss did not improve from 0.91462

Epoch 9: Learning rate is 0.01.
623/623 - 369s - loss: 0.9712 - accuracy: 0.5726 - mean_io_u: 0.1505 - val_loss: 0.9976 - val_accuracy: 0.6086 - val_mean_io_u: 0.1744 - 369s/epoch - 592ms/step
Epoch 11/100

Epoch 11: val_loss did not improve from 0.91462

Epoch 10: Learning rate is 0.01.
623/623 - 368s - loss: 0.9649 - accuracy: 0.5737 - mean_io_u: 0.1505 - val_loss: 0.9526 - val_accuracy: 0.6442 - val_mean_io_u: 0.1705 - 368s/epoch - 591ms/step
Epoch 12/100

Epoch 12: val_loss did not improve from 0.91462

Epoch 11: Learning rate is 0.01.
623/623 - 364s - loss: 0.9611 - accuracy: 0.5746 - mean_io_u: 0.1505 - val_loss: 0.9824 - val_accuracy: 0.5919 - val_mean_io_u: 0.1739 - 364s/epoch - 585ms/step
Epoch 13/100

Epoch 13: val_loss did not improve from 0.91462

Epoch 12: Learning rate is 0.01.
623/623 - 367s - loss: 0.9572 - accuracy: 0.5781 - mean_io_u: 0.1518 - val_loss: 0.9823 - val_accuracy: 0.6226 - val_mean_io_u: 0.1708 - 367s/epoch - 589ms/step
Epoch 14/100

Epoch 14: val_loss did not improve from 0.91462

Epoch 13: Learning rate is 0.01.
623/623 - 368s - loss: 0.9538 - accuracy: 0.5802 - mean_io_u: 0.1527 - val_loss: 0.9607 - val_accuracy: 0.6476 - val_mean_io_u: 0.1848 - 368s/epoch - 591ms/step
Epoch 15/100

Epoch 15: val_loss did not improve from 0.91462

Epoch 14: Learning rate is 0.01.
623/623 - 369s - loss: 0.9498 - accuracy: 0.5820 - mean_io_u: 0.1535 - val_loss: 0.9590 - val_accuracy: 0.6477 - val_mean_io_u: 0.1809 - 369s/epoch - 592ms/step
Epoch 16/100

Epoch 16: val_loss did not improve from 0.91462

Epoch 15: Learning rate is 0.01.
623/623 - 370s - loss: 0.9456 - accuracy: 0.5848 - mean_io_u: 0.1549 - val_loss: 0.9660 - val_accuracy: 0.6277 - val_mean_io_u: 0.1790 - 370s/epoch - 595ms/step
Epoch 17/100

Epoch 17: val_loss did not improve from 0.91462

Epoch 16: Learning rate is 0.01.
623/623 - 382s - loss: 0.9418 - accuracy: 0.5859 - mean_io_u: 0.1566 - val_loss: 0.9541 - val_accuracy: 0.6250 - val_mean_io_u: 0.1925 - 382s/epoch - 613ms/step
Epoch 18/100

Epoch 18: val_loss did not improve from 0.91462

Epoch 17: Learning rate is 0.01.
623/623 - 381s - loss: 0.9368 - accuracy: 0.5881 - mean_io_u: 0.1588 - val_loss: 0.9686 - val_accuracy: 0.5814 - val_mean_io_u: 0.1732 - 381s/epoch - 612ms/step
Epoch 19/100

Epoch 19: val_loss did not improve from 0.91462

Epoch 18: Learning rate is 0.01.
623/623 - 380s - loss: 0.9351 - accuracy: 0.5879 - mean_io_u: 0.1603 - val_loss: 0.9582 - val_accuracy: 0.5915 - val_mean_io_u: 0.1702 - 380s/epoch - 610ms/step
Epoch 20/100

Epoch 20: val_loss did not improve from 0.91462

Epoch 19: Learning rate is 0.01.
623/623 - 379s - loss: 0.9300 - accuracy: 0.5924 - mean_io_u: 0.1638 - val_loss: 0.9488 - val_accuracy: 0.6042 - val_mean_io_u: 0.1749 - 379s/epoch - 609ms/step
Epoch 21/100

Epoch 21: val_loss did not improve from 0.91462

Epoch 20: Learning rate is 0.001.
623/623 - 378s - loss: 0.9244 - accuracy: 0.5959 - mean_io_u: 0.1666 - val_loss: 0.9209 - val_accuracy: 0.6048 - val_mean_io_u: 0.1457 - 378s/epoch - 607ms/step
Epoch 22/100

Epoch 22: val_loss improved from 0.91462 to 0.78804, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 21: Learning rate is 0.001.
623/623 - 415s - loss: 0.9311 - accuracy: 0.5923 - mean_io_u: 0.1453 - val_loss: 0.7880 - val_accuracy: 0.6909 - val_mean_io_u: 0.2217 - 415s/epoch - 667ms/step
Epoch 23/100

Epoch 23: val_loss did not improve from 0.78804

Epoch 22: Learning rate is 0.001.
623/623 - 381s - loss: 0.9045 - accuracy: 0.6046 - mean_io_u: 0.1625 - val_loss: 0.7897 - val_accuracy: 0.6940 - val_mean_io_u: 0.2275 - 381s/epoch - 611ms/step
Epoch 24/100

Epoch 24: val_loss improved from 0.78804 to 0.78474, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 23: Learning rate is 0.001.
623/623 - 413s - loss: 0.8980 - accuracy: 0.6052 - mean_io_u: 0.1631 - val_loss: 0.7847 - val_accuracy: 0.6966 - val_mean_io_u: 0.2280 - 413s/epoch - 663ms/step
Epoch 25/100

Epoch 25: val_loss did not improve from 0.78474

Epoch 24: Learning rate is 0.001.
623/623 - 382s - loss: 0.8942 - accuracy: 0.6074 - mean_io_u: 0.1649 - val_loss: 0.7861 - val_accuracy: 0.6924 - val_mean_io_u: 0.2277 - 382s/epoch - 612ms/step
Epoch 26/100

Epoch 26: val_loss improved from 0.78474 to 0.78326, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 25: Learning rate is 0.001.
623/623 - 415s - loss: 0.8931 - accuracy: 0.6071 - mean_io_u: 0.1653 - val_loss: 0.7833 - val_accuracy: 0.6939 - val_mean_io_u: 0.2290 - 415s/epoch - 666ms/step
Epoch 27/100

Epoch 27: val_loss improved from 0.78326 to 0.78309, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 26: Learning rate is 0.001.
623/623 - 416s - loss: 0.8916 - accuracy: 0.6076 - mean_io_u: 0.1659 - val_loss: 0.7831 - val_accuracy: 0.6928 - val_mean_io_u: 0.2279 - 416s/epoch - 668ms/step
Epoch 28/100

Epoch 28: val_loss improved from 0.78309 to 0.78092, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 27: Learning rate is 0.001.
623/623 - 414s - loss: 0.8892 - accuracy: 0.6089 - mean_io_u: 0.1669 - val_loss: 0.7809 - val_accuracy: 0.6921 - val_mean_io_u: 0.2264 - 414s/epoch - 665ms/step
Epoch 29/100

Epoch 29: val_loss improved from 0.78092 to 0.78056, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 28: Learning rate is 0.001.
623/623 - 422s - loss: 0.8868 - accuracy: 0.6108 - mean_io_u: 0.1683 - val_loss: 0.7806 - val_accuracy: 0.6935 - val_mean_io_u: 0.2292 - 422s/epoch - 677ms/step
Epoch 30/100

Epoch 30: val_loss did not improve from 0.78056

Epoch 29: Learning rate is 0.001.
623/623 - 384s - loss: 0.8871 - accuracy: 0.6109 - mean_io_u: 0.1684 - val_loss: 0.7810 - val_accuracy: 0.6898 - val_mean_io_u: 0.2257 - 384s/epoch - 617ms/step
Epoch 31/100

Epoch 31: val_loss improved from 0.78056 to 0.77874, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 30: Learning rate is 0.0001.
623/623 - 418s - loss: 0.8839 - accuracy: 0.6118 - mean_io_u: 0.1689 - val_loss: 0.7787 - val_accuracy: 0.6902 - val_mean_io_u: 0.2261 - 418s/epoch - 671ms/step
Epoch 32/100

Epoch 32: val_loss improved from 0.77874 to 0.77409, saving model to ./models/Deeplabv3Plus_100e_4b_Centropy_adaptive_sgd+DA+DO

Epoch 31: Learning rate is 0.0001.
623/623 - 416s - loss: 0.8782 - accuracy: 0.6195 - mean_io_u: 0.1758 - val_loss: 0.7741 - val_accuracy: 0.6861 - val_mean_io_u: 0.2225 - 416s/epoch - 668ms/step
Epoch 33/100

Epoch 33: val_loss did not improve from 0.77409

Epoch 32: Learning rate is 0.0001.
623/623 - 379s - loss: 0.8782 - accuracy: 0.6176 - mean_io_u: 0.1745 - val_loss: 0.7750 - val_accuracy: 0.6851 - val_mean_io_u: 0.2223 - 379s/epoch - 608ms/step
Epoch 34/100

Epoch 34: val_loss did not improve from 0.77409

Epoch 33: Learning rate is 0.0001.
623/623 - 388s - loss: 0.8774 - accuracy: 0.6190 - mean_io_u: 0.1752 - val_loss: 0.7750 - val_accuracy: 0.6872 - val_mean_io_u: 0.2237 - 388s/epoch - 623ms/step
Epoch 35/100

Epoch 35: val_loss did not improve from 0.77409

Epoch 34: Learning rate is 0.0001.
623/623 - 393s - loss: 0.8772 - accuracy: 0.6186 - mean_io_u: 0.1751 - val_loss: 0.7741 - val_accuracy: 0.6883 - val_mean_io_u: 0.2237 - 393s/epoch - 631ms/step
Epoch 36/100
